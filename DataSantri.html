<div class="animate-fade-in space-y-6">
    <div class="bg-white rounded-[40px] p-8 shadow-sm border border-gray-100">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8">
            <div>
                <h2 class="text-3xl font-black text-gray-800 tracking-tight uppercase">DATABASE SANTRI</h2>
                <p class="text-gray-400 font-medium italic text-sm">Update Statistik Santri Real-time</p>
            </div>
            <div class="flex bg-gray-100 p-1.5 rounded-2xl">
                <button onclick="switchTabSantri('input')" id="tab-input" class="px-6 py-2 rounded-xl font-bold text-sm transition-all bg-white shadow-sm text-green-700">Input Data</button>
                <button onclick="switchTabSantri('list')" id="tab-list" class="px-6 py-2 rounded-xl font-bold text-sm transition-all text-gray-500">Lihat Tabel</button>
            </div>
        </div>

        <div id="view-input" class="grid grid-cols-1 lg:grid-cols-2 gap-12">
            <div class="space-y-6">
                <div class="p-6 bg-green-50 rounded-[32px] border border-green-100">
                    <label class="block text-[10px] font-black text-green-700 uppercase tracking-widest mb-2">Pilih Target Database</label>
                    <select id="targetID" class="w-full p-4 bg-white border-none rounded-2xl shadow-sm font-bold text-gray-700 focus:ring-2 focus:ring-green-500 outline-none">
                        <option value="1E_940vnYcGQAgyB2mLmUFtdSmKCJ-ZXmqv7q4-Dr6yI">DATABASE PUSAT (MAIN)</option>
                        <option value="1SD5AYyDYBUU892NoVZiyr6SS-j2XkDHzHSWkfyuf7eA">DATABASE CABANG TERPADU</option>
                    </select>
                </div>
                
                <div class="space-y-4">
                    <input type="text" id="namaLembaga" placeholder="Nama Lembaga / Cabang" class="w-full p-5 bg-gray-50 border-2 border-transparent rounded-2xl focus:border-green-500 outline-none font-bold transition-all">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-blue-50 p-4 rounded-2xl border border-blue-100">
                            <label class="text-[10px] font-black text-blue-600 uppercase tracking-widest block mb-1">Santri (L)</label>
                            <input type="number" id="jmlL" value="0" class="w-full bg-transparent text-2xl font-black outline-none">
                        </div>
                        <div class="bg-pink-50 p-4 rounded-2xl border border-pink-100">
                            <label class="text-[10px] font-black text-pink-600 uppercase tracking-widest block mb-1">Santri (P)</label>
                            <input type="number" id="jmlP" value="0" class="w-full bg-transparent text-2xl font-black outline-none">
                        </div>
                    </div>
                </div>

                <button onclick="kirimDataSantri()" id="btnSimpanSantri" class="w-full bg-green-800 text-white py-5 rounded-[24px] font-black text-lg shadow-xl shadow-green-900/20 hover:bg-green-700 active:scale-95 transition-all flex items-center justify-center gap-3">
                    <i class="fas fa-cloud-upload-alt"></i> SIMPAN KE CLOUD
                </button>
            </div>

            <div class="hidden lg:flex flex-col items-center justify-center text-center p-8 border-2 border-dashed border-gray-100 rounded-[40px]">
                <div class="w-20 h-20 bg-green-100 text-green-600 rounded-3xl flex items-center justify-center text-3xl mb-4">
                    <i class="fas fa-database"></i>
                </div>
                <h4 class="font-black text-gray-800 uppercase">Integrasi Spreadsheet</h4>
                <p class="text-sm text-gray-400 mt-2 px-10">Data yang Anda masukkan akan langsung terakumulasi ke dalam grafik dashboard utama secara otomatis.</p>
            </div>
        </div>

        <div id="view-list" class="hidden animate-fade-in">
            <div class="overflow-x-auto">
                <table class="w-full text-left">
                    <thead>
                        <tr class="text-[10px] font-black text-gray-400 uppercase tracking-widest border-b border-gray-50">
                            <th class="py-4 px-4">Tahun</th>
                            <th>Lembaga/Cabang</th>
                            <th>Laki-laki</th>
                            <th>Perempuan</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody id="tabelSantriBody" class="text-sm font-bold text-gray-600">
                        <tr class="border-b border-gray-50">
                            <td class="py-4 px-4">2024</td>
                            <td>PDF PB. AS'ADIYAH</td>
                            <td class="text-blue-600">450</td>
                            <td class="text-pink-600">520</td>
                            <td class="font-black text-gray-800">970</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    // Logika Perpindahan Tab
    function switchTabSantri(mode) {
        const btnInput = document.getElementById('tab-input');
        const btnList = document.getElementById('tab-list');
        const viewInput = document.getElementById('view-input');
        const viewList = document.getElementById('view-list');

        if (mode === 'input') {
            viewInput.classList.remove('hidden');
            viewList.classList.add('hidden');
            btnInput.classList.add('bg-white', 'shadow-sm', 'text-green-700');
            btnList.classList.remove('bg-white', 'shadow-sm', 'text-green-700');
            btnList.classList.add('text-gray-500');
        } else {
            viewInput.classList.add('hidden');
            viewList.classList.remove('hidden');
            btnList.classList.add('bg-white', 'shadow-sm', 'text-green-700');
            btnInput.classList.remove('bg-white', 'shadow-sm', 'text-green-700');
            btnInput.classList.add('text-gray-500');
        }
    }

    // Fungsi Kirim Data (Koneksi ke config.js & Google Script)
    async function kirimDataSantri() {
        const btn = document.getElementById('btnSimpanSantri');
        const nama = document.getElementById('namaLembaga').value;
        
        if(!nama) { alert("Nama Lembaga wajib diisi!"); return; }

        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> MEMPROSES...';

        const payload = {
            action: "simpanSantri",
            targetID: document.getElementById('targetID').value,
            thn: new Date().getFullYear(),
            nama: nama,
            l: document.getElementById('jmlL').value,
            p: document.getElementById('jmlP').value
        };

        try {
            const response = await fetch(CONFIG.SCRIPT_URL, { 
                method: 'POST', 
                body: JSON.stringify(payload) 
            });
            const res = await response.json();
            if(res.status === "OK") {
                alert("✅ Data Berhasil Disimpan ke Spreadsheet!");
                document.getElementById('namaLembaga').value = "";
            }
        } catch (e) {
            alert("❌ Gagal Terhubung ke Cloud. Periksa SCRIPT_URL!");
        } finally {
            btn.disabled = false;
            btn.innerHTML = '<i class="fas fa-cloud-upload-alt"></i> SIMPAN KE CLOUD';
        }
    }
</script>
